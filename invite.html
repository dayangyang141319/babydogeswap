<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport"
			content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>babydogeswap</title>
		<link rel="stylesheet" href="./css/common.css" />
		<link rel="shortcut icon" href="favicon.ico">
		<style>
			body {
				padding: 0;
				padding-bottom: 90px;
				padding-top: 64px;
				font-size: 13px;
				height: 100vh;
				box-sizing: border-box;

			}

			main {
				height: 100vh;
				box-sizing: border-box;

			}

			.inviteBg {
				position: relative;
				width: 100%;
				height: 330px;
				background: #ec502c;
				padding: 46px 25px;
				font-size: 13px;
			}

			.inviteBg .fs-27 {
				font-size: 27px;
				margin-bottom: 10px;

			}

			.inviteBg .btn {
				width: 150px;
				height: 30px;
				background: #161616;
				border-radius: 15px;
				justify-content: center;
				margin-top: 26px;
				font-size: 13px;
				line-height: 1;
				text-align: center;
			}



			.bgimg {
				position: absolute;
				top: 64px;
				right: 0;
				width: 203px;
				height: 175.5px;
			}

			.inviteWrap {
				position: relative;
				width: 100%;
				height: calc(100vh - 230px);
				background: #1d1d1d;
				border-radius: 40px 40px 0 0;
				top: -101px;
				z-index: 2;
				padding: 101px 0;
				align-items: center;
				gap: 25px;
			}

			.inviteWrap .btn {
				width: 244px;
				height: 49.5px;
				border-radius: 24.5px;
			}

			.inviteWrap .btn1 {
				border: 0.5px solid #ec502c;
				background-color: #1d1d1d;
				color: #EC502C;
			}

			.fs-12 {
				font-size: 12px;
			}

			.fs-20 {
				font-size: 20px;
			}

			.mb-10 {
				margin-bottom: 10px;
			}

			.mb-15 {
				margin-bottom: 15px;
			}

			.mb-18 {
				margin-bottom: 18px;
			}

			.mb-56 {
				margin-bottom: 56px;
			}

			.invitePopup {
				align-items: flex-end;
			}

			.inviteModal {
				width: 374.5px;
				min-height: 242px;
				background: #161616;
				border-radius: 20px 20px 0 0;
				align-items: center;
				padding: 20px 14px;
				gap: 20px;
				animation-name: slideDown;
				animation-duration: 0.4s;
				border-top: 1px solid #343434;
			}


			/* 弹窗上滑动画 */
			@keyframes slideDown {
				from {
					transform: translateY(242px);
				}

				to {
					transform: translateY(0);
				}
			}

			/* 弹窗下滑动画 */
			@keyframes slideUp {
				from {
					transform: translateY(0);
				}

				to {
					transform: translateY(242px);
				}
			}

			.inviteModal span {
				margin-bottom: 31px;
			}

			.inviteModal .btn {
				height: 49.5px;
				border-radius: 24.5px;
			}

			.inviteModal .btn1 {
				border: 0.5px solid #ec502c;
				color: #EC502C;
				background-color: #161616;
			}

			#link,#link1 {
				color: #fff;
				word-break: break-all;
				padding: 0 10px;
				text-align: center;
			}
		</style>
	</head>

	<body>
		<main>
			<div class="topNav  flex-bw">
				<span class="bold fs-20 twaName"></span>
				<div class="flex">
					<span id="setLang"></span>
					<div class="flex notBind" id="ton-connect"></div>
					<!-- <div class="flex bind">0D9...4646</div> -->
					<img class="menu" onclick="showMore()" src="./images/menu.png" alt="">
				</div>
			</div>
			<div class="inviteBg">
				<div class="fs-27" id="inviteText1">邀请好友</div>
				<div id="inviteText2">获得更多babydoge</div>
				<div class="flex btn" id="inviteText3">点击下方按钮分享好友</div>
				<img class="bgimg" src="./images/inviteimg.png" alt="">
			</div>
			<div class="inviteWrap flex1">
				<div class="btn" id="inviteText4" onclick="showPopup()">邀请好友</div>
				<a class="btn btn1" id="inviteText5" href="myTeam.html">查看我的团队</a>
			</div>
			<!-- 邀请弹窗 -->
			<div class="popup invitePopup" id="invitePopup">
				<div class="flex1 inviteModal" id="inviteModal">
					<span id="inviteText6"></span>
					<div class="btn btn1" id="link"></div>
					<div class="btn" id="inviteText9" onclick="toCopy(1)">分享邀请链接</div>
					<div class="btn btn1" id="link1"></div>
					<!-- <div class="btn btn1" id="inviteText7" onclick="toCopy()">复制邀请链接</div> -->
					<div class="btn" id="inviteText8" onclick="toCopy(2)">分享邀请链接</div>
				</div>
			</div>
			<!-- 更多菜单 -->
			<div class="popup rightPopup" id="morePopup">
				<div class="moreModal flex1" id="moreModal">
					<span class="bold twaName"></span>
					<div class="walletBtn flex">
						<div class="flex">
							<span id="moreText1"></span>
							<span id="walletAddress"></span>
						</div>
						<img src="./images/copy.png" onclick="copy()" alt="">
					</div>
					<a class="flex-bw" href="index.html">
						<span id="moreText2"></span>
						<img src="./images/right.png" alt="">
					</a>
					<a class="flex-bw" href="wallet.html">
						<span id="moreText3"></span>
						<img src="./images/right.png" alt="">
					</a>
					<a class="flex-bw" href="ranking.html">
						<span id="moreText4"></span>
						<img src="./images/right.png" alt="">
					</a>
					<a class="flex-bw" href="invite.html">
						<span id="moreText5"></span>
						<img src="./images/right.png" alt="">
					</a>
				</div>
			</div>
			<!-- 加载弹窗 -->
			<div id="loadingModal" class="loadingModal">
				<div class="modal-content">
					<p id="loadText"></p>
					<img src="images/loading.png" alt="" />
				</div>
			</div>
			<!-- 提示弹窗 -->
			<div id="toastModal" class="toastModal">
				<div class="modal-content">
					<p id="toastMsg"></p>
				</div>
			</div>
		</main>
		<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
		<script src="https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.16.0/js/md5.js"></script>
		<script src="./js/http.js"></script>
		<script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
		<!-- <script src="https://telegram.org/js/telegram-web-app.js"></script> -->
		<script>
			let invitePopup = document.getElementById('invitePopup')
			let inviteModal = document.getElementById('inviteModal')
			let githubUrl = localStorage.getItem('githubUrl') || ''
			let tmeUrl = localStorage.getItem('tmeUrl') || ''
		

			function trsAddress(address) {
				let addr = TonConnectSDK.toUserFriendlyAddress(address)
				localStorage.setItem('userAddress', addr)
				$('#walletAddress').text(sliceAddress(addr, 4, 4))
				return addr
			}

			function getInfo() {
				apiHttp($, "/api/contract/user/index").then(res => {
					if (res.code == 1) {
						githubUrl = res.data.githubUrl
						tmeUrl = res.data.tmeUrl
						$('#link1').text(githubUrl)
						localStorage.setItem('githubUrl', githubUrl)
						$('#link').text(tmeUrl)
						localStorage.setItem('tmeUrl', tmeUrl)
					}
				})
			}

			function toCopy(i) {
				// console.log('posterUrl', posterUrl);
				// if (posterUrl) {
				// 	copyTextToClipboard(posterUrl)
				// 	if (baseLang == 'EN') {
				// 		toast('Replicating Success')
				// 	} else {
				// 		toast('复制成功')
				// 	}
				// }
				console.log('tmeUrl', tmeUrl);
				if (tmeUrl) {
					copyTextToClipboard(i==1?tmeUrl:githubUrl)
					if (baseLang == 'EN') {
						toast('Replicating Success')
					} else {
						toast('复制成功')
					}
				}
			}

			function showPopup() {
				invitePopup.style.display = 'flex'
				inviteModal.style.animation = "slideDown 0.4s forwards"; // 应用下滑动画  
			}


			async function loadData() {
				await showLoading()
				await getIndexInfo()
				// if (!posterUrl) {
				// 	getInfo()
				// } else {
				// 	$('#link').text(posterUrl)
				// }
				if (!tmeUrl || !githubUrl) {
					getInfo()
				} else {
					$('#link').text(tmeUrl)
					$('#link1').text(githubUrl)
				}
				reloadText()
				loadFooterText()
				hideLoading()
			}
			if (token) {
				loadData()
			}

			function reloadText() {
				if (baseLang == 'EN') {
					$('#inviteText1').html('Invite friends')
					$('#inviteText2').html('Get more babydoge')
					$('#inviteText3').html('Click the button below to share friends')
					$('#inviteText4').html('Invite friends')
					$('#inviteText5').html('View my team')
					$('#inviteText6').html('Invite friends')
					$('#inviteText7').html('Copy invitation link')
					$('#inviteText8').html('Copy invitation link')
					$('#inviteText9').html('Copy invitation link')
				} else {
					$('#inviteText1').html('邀请好友')
					$('#inviteText2').html('获得更多babydoge')
					$('#inviteText3').html('点击下方按钮分享好友')
					$('#inviteText4').html('邀请好友')
					$('#inviteText5').html('查看我的团队')
					$('#inviteText6').html('邀请好友')
					$('#inviteText7').html('复制邀请链接')
					$('#inviteText8').html('复制邀请链接')
					$('#inviteText9').html('复制邀请链接')
				}
			}
			// 点击模态框外部时，也关闭它
			window.onclick = function(event) {
				console.log('window.onclick10011111111111111');
				if (event.target == morePopup) {
					moreModal.style.animation = "toRightAnimate 0.4s forwards"; // 应用上滑动画  
					setTimeout(() => {
						morePopup.style.display = "none";
					}, 200)
				} else if (event.target == invitePopup) {
					// invitePopup.style.display = "none";
					inviteModal.style.animation = "slideUp 0.4s forwards"; // 应用上滑动画  
					setTimeout(function() {
						invitePopup.style.display = "none";
					}, 40); // 动画完成后隐藏模态框 
				}
			}
		</script>

		<!-- Eruda is console for mobile browsers -->
		<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
		<script>
			eruda.init();
		</script>
	</body>
</html>